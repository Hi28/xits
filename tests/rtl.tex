\doifmodeelse{ltr}{}
{
	\mathdir TRT % right to left direction
	% register 'rtlm' feature for base mode
	\ctxlua{fonts.otf.features.register_base_substitution('rtlm')}
	% activate it for math
	\definefontfeature[virtualmath][virtualmath][rtlm=yes]
}

\starttypescript    [math]     [xits][name]
  \definefontsynonym[MathRoman][file:../xits-math.otf] [features=virtualmath]
\stoptypescript

\starttypescript[mainface]
  \definetypeface   [mainface][rm][serif] [termes] [default]
  \definetypeface   [mainface][mm][math]  [xits]  [default]
\stoptypescript

\usetypescript[mainface]
\setupbodyfont[mainface]

\starttext
\startformula
\int^1_2 1234567890
\stopformula

\startformula
\sum^1_2 1234567890
\stopformula

\startformula
\sqrt{\sqrt{\sqrt{\sqrt{\sqrt{\sqrt{\sqrt{\sqrt{\sqrt{\sqrt{0123456789}}}}}}}}}}
\stopformula
\stoptext
